(function(){function t(n){var t=[],h,f,e,u,o,s,l,c;if(n.rec_type){for(h=scheduler.getRecDates(n),f=0;f<h.length;f++)for(e=scheduler.getEvents(h[f].start_date,h[f].end_date),u=0;u<e.length;u++)(e[u].event_pid||e[u].id)!=n.id&&t.push(e[u]);t.push(n)}else t=scheduler.getEvents(n.start_date,n.end_date);if(o=scheduler._props?scheduler._props[scheduler._mode]:null,s=!0,o){for(l=0,c=0;c<t.length;c++)t[c][o.map_to]==n[o.map_to]&&l++;l>scheduler.config.collision_limit&&(scheduler._drag_event.start_date=r,n[o.map_to]=i,s=!1)}else t.length>scheduler.config.collision_limit&&(s=!1);return s?s:!scheduler.callEvent("onEventCollision",[n,t])}var i,r,n;scheduler.config.collision_limit=1e3;scheduler.attachEvent("onBeforeDrag",function(n){var t=scheduler._props?scheduler._props[this._mode]:null;return t&&n&&(i=this.getEvent(n)[t.map_to],r=this.getEvent(n).start_date),!0});scheduler.attachEvent("onBeforeLightbox",function(t){var i=scheduler.getEvent(t);return n=[i.start_date,i.end_date],!0});scheduler.attachEvent("onEventChanged",function(i){if(!i)return!0;var r=scheduler.getEvent(i);if(!t(r)){if(!n)return!1;r.start_date=n[0];r.end_date=n[1];r._timed=this.is_one_day_event(r)}return!0});scheduler.attachEvent("onBeforeEventChanged",function(n){return t(n)});scheduler.attachEvent("onEventSave",function(n,i){if(i.rec_type){var r=i.start_date.getFullYear(),u=i.start_date.getMonth(),f=i.start_date.getDate(),e=i.start_date.getHours(),o=i.start_date.getMinutes();scheduler._roll_back_dates(i);i.start_date=new Date(r,u,f,e,o)}return t(i)})})()