scheduler.config.year_x=4;scheduler.config.year_y=3;scheduler.config.year_mode_name="year";scheduler.xy.year_top=0;scheduler.templates.year_date=function(n){return scheduler.date.date_to_str(" %Y"+scheduler.locale.labels.year_tab)(n)};scheduler.templates.year_month=scheduler.date.date_to_str("%F");scheduler.templates.year_scale_date=scheduler.date.date_to_str("%D");scheduler.templates.year_tooltip=function(n,t,i){var r=bssgetmyuserid();return scheduler._showbox_check(i)==!0&&(i.text=scheduler.locale.labels.title_private_flg),i.text},function(){var n=function(){return scheduler._mode==scheduler.config.year_mode_name},i,r,t;scheduler.dblclick_dhx_month_head=function(t){var r,i,u,f;if(n()){if(r=t.target||t.srcElement,r.parentNode.className.indexOf("dhx_before")!=-1||r.parentNode.className.indexOf("dhx_after")!=-1)return!1;i=this.templates.xml_date(r.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("date"));i.setDate(parseInt(r.innerHTML,10));u=this.config.first_hour;u>i.getHours()&&i.setHours(u);f=this.date.add(i,this.config.time_step,"minute");!this.config.readonly&&this.config.dblclick_create&&this.addEventNow(i.valueOf(),f.valueOf(),t)}};i=scheduler.changeEventId;scheduler.changeEventId=function(){i.apply(this,arguments);n()&&this.year_view(!0)};var u=scheduler.render_data,f=scheduler.date.date_to_str("%Y/%m/%d"),e=scheduler.date.str_to_date("%Y/%m/%d");scheduler.render_data=function(t){if(!n())return u.apply(this,arguments);for(var i=0;i<t.length;i++)this._year_render_event(t[i])};r=scheduler.clear_view;scheduler.clear_view=function(){if(!n())return r.apply(this,arguments);for(var i=0;i<t.length;i++)t[i].className="dhx_month_head",t[i].setAttribute("date","");t=[]};scheduler.hideToolTip=function(){this._tooltip&&(this._tooltip.style.display="none",this._tooltip.date=new Date(9999,1,1))};scheduler.showToolTip=function(n,t,i,r){var s,h,f,o;if(this._tooltip){if(this._tooltip.date.valueOf()==n.valueOf())return;this._tooltip.innerHTML=""}else s=this._tooltip=document.createElement("DIV"),s.className="dhx_tooltip",h=document.getElementById("dhx_cal_tooltips"),h.appendChild(s),s.onclick=scheduler._click.dhx_cal_data;var u=this.getEvents(n,this.date.add(n,1,"day")),e="",p=bssgetmyuserid();for(f=0;f<u.length;f++)o="0",scheduler._showbox_check(u[f])==!0&&(o="1"),e+="<div class='dhx_tooltip_line' event_id='"+u[f].id+"' show_flg='"+o+"'>",e+="<div class='dhx_tooltip_date' show_flg='"+o+"'>"+(u[f]._timed?this.templates.event_date(u[f].start_date)+" - "+this.templates.event_date(u[f].end_date):"")+"<\/div>",e+="<div class='dhx_event_icon icon_details' show_flg='"+o+"'>&nbsp;<\/div>",e+=scheduler._getPriority_icon(u[f]),e+=this.templates.year_tooltip(u[f].start_date,u[f].end_date,u[f])+"<\/div>";this._tooltip.style.display="";this._tooltip.style.top="0px";this._tooltip.date=n;this._tooltip.innerHTML=e;var a=document.getElementById("scheduler_here"),c=a.getBoundingClientRect(),u=document.body,l=document.documentElement,v=window.pageYOffset||l.scrollTop||u.scrollTop,y=window.pageXOffset||l.scrollLeft||u.scrollLeft;htop=c.top+v;hleft=c.left+y;this._tooltip.style.top=document.body.offsetHeight-t.top-htop-this._tooltip.offsetHeight<0?t.top-htop-this._tooltip.offsetHeight+"px":t.top-htop+"px";this._tooltip.style.left=t.left-hleft-this._tooltip.offsetWidth>0?t.left-hleft-this._tooltip.offsetWidth+"px":t.left-hleft+r.offsetWidth+"px"};scheduler._init_year_tooltip=function(){dhtmlxEvent(scheduler._els.dhx_cal_data[0],"mouseover",function(t){if(n()){var t=t||event,i=t.target||t.srcElement;(i.className||"").indexOf("dhx_year_event")!=-1?scheduler.showToolTip(e(i.getAttribute("date")),getOffset(i),t,i):scheduler.hideToolTip()}});this._init_year_tooltip=function(){}};scheduler.attachEvent("onSchedulerResize",function(){return n()?(this.year_view(!0),!1):!0});scheduler._get_year_cell=function(n){var t=n.getMonth()+12*(n.getFullYear()-this._min_date.getFullYear())-this.week_starts._month,i=this._els.dhx_cal_data[0].childNodes[t],n=this.week_starts[t]+n.getDate()-1;return i.childNodes[2].firstChild.rows[Math.floor(n/7)].cells[n%7].firstChild};t=[];scheduler._mark_year_date=function(n,i){var r=this._get_year_cell(n);r.className="dhx_month_head dhx_year_event "+this.templates.event_class(i.start_date,i.end_date,i);r.setAttribute("date",f(n));t.push(r)};scheduler._unmark_year_date=function(n){this._get_year_cell(n).className="dhx_month_head"};scheduler._year_render_event=function(n){for(var t=n.start_date,t=t.valueOf()<this._min_date.valueOf()?this._min_date:this.date.date_part(new Date(t));t<n.end_date;)if(this._mark_year_date(t,n),t=this.date.add(t,1,"day"),t.valueOf()>=this._max_date.valueOf())return};scheduler.year_view=function(n){if(n){var t=scheduler.xy.scale_height;scheduler.xy.scale_height=-1}(scheduler._els.dhx_cal_header[0].style.display=n?"none":"",scheduler.set_sizes(),n&&(scheduler.xy.scale_height=t),scheduler._table_view=n,this._load_mode&&this._load())||(n?(scheduler._init_year_tooltip(),scheduler._reset_year_scale(),scheduler.render_view_data()):scheduler.hideToolTip())};scheduler._reset_year_scale=function(){var s,f,t,l,n,h,i,o,c,w;this._cols=[];this._colsS={};var a=[],r=this._els.dhx_cal_data[0],u=this.config;r.scrollTop=0;r.innerHTML="";s=Math.floor(parseInt(r.style.width)/u.year_x);f=Math.floor((parseInt(r.style.height)-scheduler.xy.year_top)/u.year_y);f<190&&(f=190,s=Math.floor((parseInt(r.style.width)-scheduler.xy.scroll_width)/u.year_x));var b=s-11,k=0,v=document.createElement("div"),y=this.date.week_start(new Date);for(n=0;n<7;n++)this._cols[n]=Math.floor(b/(7-n)),this._render_x_header(n,k,y,v),y=this.date.add(y,1,"day"),b-=this._cols[n],k+=this._cols[n];for(v.lastChild.className+=" dhx_scale_bar_last",t=this.date[this._mode+"_start"](this.date.copy(this._date)),l=t,n=0;n<u.year_y;n++)for(h=0;h<u.year_x;h++){i=document.createElement("DIV");i.style.cssText="position:absolute;";i.setAttribute("date",this.templates.xml_format(t));i.innerHTML="<div class='dhx_year_month'><\/div><div class='dhx_year_week'>"+v.innerHTML+"<\/div><div class='dhx_year_body'><\/div>";i.childNodes[0].innerHTML=this.templates.year_month(t);var d=this.date.week_start(t),p=this._reset_month_scale(i.childNodes[2],t,d),e=i.childNodes[2].firstChild.rows;for(o=e.length;o<6;o++)for(e[0].parentNode.appendChild(e[0].cloneNode(!0)),c=0;c<e[o].childNodes.length;c++)e[o].childNodes[c].className="dhx_after",e[o].childNodes[c].firstChild.innerHTML=scheduler.templates.month_day(p),p=scheduler.date.add(p,1,"day");r.appendChild(i);w=Math.round((f-190)/2);i.style.marginTop=w+"px";this.set_xy(i,s-10,f-w-10,s*h+5,f*n+5+scheduler.xy.year_top);a[n*u.year_x+h]=(t.getDay()-(this.config.start_on_monday?1:0)+7)%7;t=this.date.add(t,1,"month")}this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](l,t,this._mode);this.week_starts=a;a._month=l.getMonth();this._min_date=l;this._max_date=t}}()